<!-- --- START OF FILE User_Panel_Final_Pro.html --- -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Fworker Premium App</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <style>
        :root {
            --primary: #FFD700; /* Gold */
            --primary-dark: #C5A000;
            --bg: #F0F2F5;
            --card-bg: #FFFFFF;
            --text-main: #1F2937;
            --text-sec: #6B7280;
            --border: #E5E7EB;
            --shadow: 0 8px 24px rgba(0,0,0,0.08);
            --radius: 20px;
        }

        /* Dark Mode Variables */
        body.dark-mode {
            --bg: #111827;
            --card-bg: #1F2937;
            --text-main: #F9FAFB;
            --text-sec: #9CA3AF;
            --border: #374151;
            --shadow: 0 8px 24px rgba(0,0,0,0.4);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Poppins', sans-serif; -webkit-tap-highlight-color: transparent; }
        body { background: var(--bg); color: var(--text-main); padding-bottom: 90px; min-height: 100vh; transition: background 0.3s, color 0.3s; }

        /* Animations */
        @keyframes fadeIn { from{opacity:0; transform: translateY(10px);} to{opacity:1; transform: translateY(0);} }
        .animate-up { animation: fadeIn 0.4s ease-out forwards; }
        @keyframes popIn { 0% { transform: scale(0.8); opacity: 0; } 100% { transform: scale(1); opacity: 1; } }

        /* Loading Screen */
        #loading-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: var(--bg); z-index: 6000; display: flex;
            flex-direction: column; justify-content: center; align-items: center;
        }

        /* Auth Screen */
        .full-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: var(--bg); z-index: 2000; display: flex;
            flex-direction: column; justify-content: center; align-items: center; padding: 25px; overflow-y: auto;
        }
        .auth-card {
            background: var(--card-bg); width: 100%; max-width: 380px;
            padding: 30px; border-radius: 24px; box-shadow: var(--shadow);
            text-align: center; border: 1px solid var(--border); margin-bottom: 20px;
        }
        /* Auth Logo */
        .auth-logo-img { max-width: 140px; max-height: 80px; object-fit: contain; margin-bottom: 15px; display: block; margin: 0 auto 15px; }

        .input-group { position: relative; margin-bottom: 15px; }
        .input-group i { position: absolute; left: 15px; top: 50%; transform: translateY(-50%); color: var(--text-sec); font-size: 1rem; }
        .form-control {
            width: 100%; padding: 14px 14px 14px 45px; border: 1px solid var(--border);
            border-radius: 12px; background: var(--bg); color: var(--text-main); outline: none; font-size: 0.95rem;
        }
        .form-control:focus { border-color: var(--primary); border-width: 1px; box-shadow: 0 0 0 3px rgba(255, 215, 0, 0.2); }

        /* Buttons */
        .btn {
            width: 100%; padding: 14px; border: none; border-radius: 14px;
            background: linear-gradient(135deg, #FFD700, #FDB931);
            color: #000; font-weight: 700; font-size: 1rem; cursor: pointer; 
            box-shadow: 0 4px 15px rgba(255, 215, 0, 0.4); transition: all 0.3s ease;
            position: relative; overflow: hidden; margin-top: 10px;
        }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(255, 215, 0, 0.5); }
        .btn:active { transform: translateY(1px); }

        .btn-create-link { display: block; width: 100%; text-align: right; font-size: 0.85rem; color: #3B82F6; font-weight: 600; background: none; border: none; cursor: pointer; margin-top: -10px; margin-bottom: 15px; }
        .link-text { margin-top: 15px; font-size: 0.9rem; color: var(--text-sec); cursor: pointer; }
        .link-text span { color: var(--primary-dark); font-weight: 600; }
        
        /* Header & Profile */
        .app-header {
            background: var(--card-bg); padding: 25px 20px; border-radius: 0 0 35px 35px;
            box-shadow: var(--shadow); position: relative; margin-bottom: 25px;
        }
        .header-top { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        
        /* NEW LOGO STYLE - Main App Header */
        .app-main-logo {
            height: 50px; /* লোগোর সাইজ এখান থেকে কন্ট্রোল করবেন */
            width: auto;
            max-width: 180px;
            object-fit: contain;
            display: block;
        }

        .header-icons i { font-size: 1.5rem; cursor: pointer; margin-left: 18px; color: var(--text-main); transition: 0.2s; }
        
        .profile-container { display: flex; align-items: center; gap: 15px; }
        .profile-pic {
            width: 75px; height: 75px; border-radius: 50%; object-fit: cover;
            border: 3px solid var(--primary); padding: 2px; background: var(--card-bg);
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }
        .user-details h2 { font-size: 1.3rem; font-weight: 700; display: flex; align-items: center; gap: 5px; margin-bottom: 2px; }
        .verified { color: #3B82F6; font-size: 0.95rem; }
        .user-meta { font-size: 0.85rem; color: var(--text-sec); display: flex; flex-direction: column; gap: 2px; }

        /* Components */
        .section-title { font-size: 1.1rem; font-weight: 700; margin: 25px 0 12px; padding: 0 5px; display: flex; align-items: center; gap: 10px; color: var(--text-main); }
        .card {
            background: var(--card-bg); padding: 18px; border-radius: var(--radius);
            box-shadow: var(--shadow); border: 1px solid var(--border); margin-bottom: 18px; transition: 0.3s;
        }
        .mobile-ad-container {
            width: 100%; max-width: 340px; margin: 15px auto;
            background: #ffffff; border: 1px solid #e0e0e0; border-radius: 10px;
            padding: 5px; box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            display: flex; justify-content: center; align-items: center; overflow: hidden; min-height: 60px;
        }
        
        .notice-container {
            background: var(--card-bg); border-radius: 12px; padding: 12px;
            box-shadow: var(--shadow); border: 1px solid var(--border); margin-bottom: 18px;
            position: relative; overflow: hidden;
        }
        .notice-badge {
            font-size: 0.7rem; font-weight: 700; background: var(--primary); color: #000;
            padding: 3px 10px; border-radius: 6px; text-transform: uppercase;
            display: inline-block; margin-bottom: 5px;
        }
        .marquee { white-space: nowrap; animation: scroll 15s linear infinite; font-size: 0.95rem; color: var(--text-main); }
        @keyframes scroll { 0% {transform: translateX(100%);} 100% {transform: translateX(-100%);} }

        .social-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; }
        .social-item {
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            background: var(--bg); padding: 15px 5px; border-radius: 16px; text-decoration: none;
            color: var(--text-main); font-size: 0.8rem; font-weight: 600;
        }
        .social-item i { font-size: 1.6rem; margin-bottom: 8px; }

        /* Sessions */
        .session-card {
            background: linear-gradient(135deg, #1F2937, #000); color: #fff;
            padding: 22px; border-radius: var(--radius); margin-bottom: 15px;
            display: flex; justify-content: space-between; align-items: center;
            position: relative; overflow: hidden; cursor: pointer; transition: 0.3s;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        .session-card::after {
            content: ''; position: absolute; right: -20px; bottom: -20px;
            width: 90px; height: 90px; background: var(--primary); opacity: 0.15; border-radius: 50%;
        }
        .session-info h3 { margin-bottom: 5px; font-size: 1.2rem; }
        .session-earn { font-size: 0.9rem; color: var(--primary); font-weight: 600; background: rgba(255, 215, 0, 0.15); padding: 4px 10px; border-radius: 8px; display: inline-block; }
        .play-icon { font-size: 2.2rem; color: var(--primary); z-index: 2; }

        .rules-content {
            font-size: 0.9rem; line-height: 1.6; color: var(--text-main);
            display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden;
        }
        .rules-content.expanded { -webkit-line-clamp: unset; overflow: visible; }
        .see-more-btn {
            display: block; width: 100%; text-align: center; margin-top: 12px;
            color: var(--primary-dark); font-size: 0.9rem; font-weight: 600;
            cursor: pointer; padding: 8px; background: var(--bg); border-radius: 10px;
        }

        .support-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .admin-card {
            background: var(--card-bg); border: 1px solid var(--border);
            padding: 18px; border-radius: 18px; text-align: center;
            box-shadow: var(--shadow); display: flex; flex-direction: column; align-items: center;
        }
        .admin-pic { width: 60px; height: 60px; border-radius: 50%; object-fit: cover; border: 2px solid var(--primary); margin-bottom: 10px; }
        .admin-name { font-weight: 600; font-size: 0.95rem; margin-bottom: 12px; color: var(--text-main); }
        .contact-btns { display: flex; gap: 10px; width: 100%; justify-content: center; }
        .c-btn {
            flex: 1; padding: 8px; border-radius: 10px; border: none; color: white;
            font-size: 1.1rem; cursor: pointer; display: flex; justify-content: center; align-items: center; text-decoration: none;
        }
        .btn-wa { background: #25D366; }
        .btn-tg { background: #0088cc; }

        /* === IMPORTANT: SCROLL FIX FOR SESSION OVERLAY === */
        .full-page-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: var(--bg); z-index: 4000; 
            display: none; 
            flex-direction: column; /* Use Flexbox to manage height */
            overflow: hidden; /* Main container doesn't scroll, inner does */
        }
        .full-page-header {
            background: var(--card-bg); padding: 0 15px;
            box-shadow: var(--shadow); display: flex; align-items: center; justify-content: space-between;
            position: relative; z-index: 10; height: 60px; flex-shrink: 0;
        }
        
        /* This container takes all remaining space */
        .html-container {
            width: 100%; 
            flex: 1; /* Fills remaining height */
            position: relative;
            background: #ffffff;
            overflow-y: hidden; /* Let iframe handle scroll */
        }
        /* Iframe settings for proper scrolling */
        .html-frame { 
            width: 100%; 
            height: 100%; 
            border: none; 
            display: block;
        }

        /* Floating Start Button */
        #btn-start-task {
            position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%);
            width: 90%; z-index: 4002;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            /* Ensure it doesn't block clicks when hidden */
            display: none; 
        }

        /* Modals & Bottom Nav */
        .bottom-nav {
            position: fixed; bottom: 0; left: 0; width: 100%; height: 75px;
            background: var(--card-bg); border-top: 1px solid var(--border);
            display: flex; justify-content: space-around; align-items: center; z-index: 1000;
            border-radius: 25px 25px 0 0; box-shadow: 0 -5px 20px rgba(0,0,0,0.05);
        }
        .nav-item { text-align: center; color: var(--text-sec); font-size: 0.8rem; cursor: pointer; }
        .nav-item i { font-size: 1.5rem; margin-bottom: 5px; display: block; }
        .nav-item.active { color: var(--primary-dark); }
        
        .modal {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.8); z-index: 3000; padding: 20px; overflow-y: auto; justify-content: center; align-items: center;
        }
        .modal-content-box {
            background: var(--card-bg); width: 100%; max-width: 400px; 
            border-radius: 24px; padding: 25px; position: relative; margin: auto;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3); border: 1px solid var(--border);
        }
        
        .credential-box { background: var(--bg); border: 1px dashed var(--primary); border-radius: 14px; padding: 15px; margin-top: 15px; }
        .cred-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; font-size: 0.9rem; }
        .cred-val { font-family: monospace; font-weight: 600; background: rgba(0,0,0,0.05); padding: 2px 6px; border-radius: 4px; }
        .cred-icon { cursor: pointer; padding: 5px; color: var(--primary-dark); }

        .entry-modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9); z-index: 5000; display: none;
            justify-content: center; align-items: center; padding: 20px;
        }
        .entry-box {
            background: var(--card-bg); width: 100%; max-width: 380px;
            border-radius: 20px; padding: 20px; text-align: center; position: relative;
            animation: popIn 0.4s ease; border: 1px solid var(--primary);
        }
        .entry-banner { width: 100%; height: 160px; object-fit: cover; border-radius: 12px; margin-bottom: 15px; border: 1px solid var(--border); }
        .entry-btns { display: flex; gap: 10px; margin-bottom: 15px; }
        .entry-btn {
            flex: 1; padding: 12px; border-radius: 10px; text-decoration: none;
            font-size: 0.85rem; font-weight: 600; color: white; display: flex;
            align-items: center; justify-content: center; gap: 5px; transition: 0.2s;
        }

        .hide { display: none !important; }
        .toggle-switch { position: relative; display: inline-block; width: 50px; height: 26px; }
        .toggle-switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 34px; }
        .slider:before { position: absolute; content: ""; height: 20px; width: 20px; left: 3px; bottom: 3px; background-color: white; transition: .4s; border-radius: 50%; }
        input:checked + .slider { background-color: var(--primary); }
        input:checked + .slider:before { transform: translateX(24px); }

    </style>
</head>
<body>

    <!-- === 0. AUTO LOGIN LOADING SCREEN === -->
    <div id="loading-screen" class="full-screen" style="z-index: 6000; background: var(--bg);">
        <i class="fas fa-circle-notch fa-spin" style="font-size: 3rem; color: var(--primary); margin-bottom: 20px;"></i>
        <h3 style="color: var(--text-main);">Auto Login...</h3>
        <p style="color: var(--text-sec); font-size: 0.9rem;">Please wait...</p>
    </div>

    <!-- === 1. ENTRY POPUP === -->
    <div id="entry-popup" class="entry-modal-overlay">
        <div class="entry-box">
            <img id="entry-banner-img" src="https://via.placeholder.com/300x150" class="entry-banner">
            <h3 id="entry-title" style="margin-bottom:10px;">Welcome</h3>
            <p id="entry-desc" style="color:var(--text-sec); font-size:0.9rem; margin-bottom:20px;">Join our channels for updates.</p>
            <div class="entry-btns">
                <a id="btn-join-tg" href="#" target="_blank" class="entry-btn" style="background:#0088cc;"><i class="fab fa-telegram-plane"></i> Telegram</a>
                <a id="btn-join-pay" href="#" target="_blank" class="entry-btn" style="background:#10B981;"><i class="fas fa-users"></i> Pay Group</a>
            </div>
            <button class="btn" onclick="closeEntryPopup()">Check Now</button>
        </div>
    </div>

    <!-- === 2. AUTH SCREENS === -->
    <div id="login-screen" class="full-screen hide">
        <div class="auth-card animate-up">
            <!-- Login Logo (Image) -->
            <img src="https://via.placeholder.com/150" class="auth-logo-img" id="login-logo-img">
            
            <p id="login-desc-text" style="color:var(--text-sec); margin-bottom:20px; font-size:0.9rem;">Welcome back! Access your account.</p>
            <div class="input-group">
                <i class="fas fa-id-card"></i>
                <input type="text" id="log-fw" class="form-control" placeholder="Fworker Number">
            </div>
            <div class="input-group">
                <i class="fas fa-lock"></i>
                <input type="password" id="log-pass" class="form-control" placeholder="Password">
            </div>
            <button class="btn" onclick="userLogin()">Access Now</button>
            <div class="link-text" onclick="showRegister()">New User? <span>Create Account</span></div>
        </div>
        <div class="auth-footer animate-up" style="text-align:center;">
            <p style="font-size:0.85rem; color:var(--text-sec);">Please follow our <span style="color:var(--primary-dark); cursor:pointer; font-weight:600;" onclick="showInfo('rules')">Rules</span> before joining.</p>
        </div>
    </div>

    <div id="register-screen" class="full-screen hide">
        <div class="auth-card animate-up">
             <!-- Register Logo (Image) -->
            <img src="https://via.placeholder.com/150" class="auth-logo-img" id="reg-logo-img">
            
            <h2 style="margin-bottom:10px;">Join Us</h2>
            <div class="input-group"><i class="fas fa-user"></i><input id="reg-name" class="form-control" placeholder="Full Name"></div>
            <div class="input-group"><i class="fas fa-id-card"></i><input id="reg-fw" class="form-control" placeholder="Fworker Number"></div>
            <div class="input-group"><i class="fas fa-envelope"></i><input type="email" id="reg-email" class="form-control" placeholder="Email Address"></div>
            <div class="input-group"><i class="fas fa-lock"></i><input type="password" id="reg-pass" class="form-control" placeholder="Password"></div>
            <div class="input-group"><i class="fas fa-wallet"></i><input id="reg-pay" class="form-control" placeholder="Payment Number (Bkash/Nagad)"></div>
            <div class="input-group" style="margin-bottom:5px;"><i class="fas fa-link"></i><input id="reg-proof" class="form-control" placeholder="Screenshot Link (Proof)"></div>
            <button class="btn-create-link" onclick="createLink()">Link তৈরি করুন <i class="fas fa-external-link-alt"></i></button>
            <button class="btn" onclick="userRegister()">Submit Request</button>
            <div class="link-text" onclick="showLogin()">Already have account? <span>Login</span></div>
        </div>
    </div>

    <div id="pending-screen" class="full-screen hide">
        <div class="auth-card animate-up">
            <i class="fas fa-hourglass-half" style="font-size:3.5rem; color:var(--primary); margin-bottom:20px;"></i>
            <h2>Approval Pending</h2>
            <p style="color:var(--text-sec); margin:10px 0; font-size:0.9rem; line-height:1.5;">Your account is currently under review.</p>
            <button class="btn" onclick="location.reload()">Check Status</button>
        </div>
    </div>

    <!-- === 3. MAIN APP === -->
    <div id="main-app" class="hide">
        <div class="app-header">
            <div class="header-top">
                <!-- IMPORTANT: YOUR COMPANY LOGO HERE -->
                <!-- এই ইমেজের src পরিবর্তন করে আপনার লোগো দিন অথবা এডমিন প্যানেল থেকে config এ সেট করুন -->
                <img id="app-logo-main" src="https://via.placeholder.com/180x50" class="app-main-logo" alt="Fworker">
                
                <div class="header-icons">
                    <i class="fas fa-bell" onclick="showPopup()"></i>
                    <i class="fas fa-cog" onclick="openSettings()"></i>
                </div>
            </div>
            <div class="profile-container">
                <img id="head-pic" src="https://via.placeholder.com/100" class="profile-pic">
                <div class="user-details" style="flex:1;">
                    <h2 id="head-name">User Name <i class="fas fa-check-circle verified"></i></h2>
                    <div class="user-meta">
                        <span id="head-email"><i class="fas fa-envelope"></i> email@example.com</span>
                        <span id="head-phone"><i class="fas fa-phone"></i> +8801700000000</span>
                    </div>
                </div>
            </div>
        </div>

        <div style="padding: 0 20px;">
            <div class="notice-container">
                <div class="notice-badge">NOTICE</div>
                <div class="marquee" id="notice-text">Welcome to Fworker Official App. Stay tuned for updates!</div>
            </div>

            <div id="ad-zone-1" class="mobile-ad-container"></div>

            <div class="card">
                <div class="social-grid">
                    <a id="lnk-fb" href="#" class="social-item"><i class="fab fa-facebook" style="color:#1877F2"></i> Group</a>
                    <a id="lnk-tg" href="#" class="social-item"><i class="fab fa-telegram" style="color:#0088cc"></i> Channel</a>
                    <a id="lnk-pay" href="#" class="social-item"><i class="fas fa-receipt" style="color:#10B981"></i> Proof</a>
                    <a id="lnk-yt" href="#" class="social-item"><i class="fab fa-youtube" style="color:#EF4444"></i> Video</a>
                </div>
            </div>

            <div id="ad-zone-2" class="mobile-ad-container"></div>
            <div class="section-title"><i class="fas fa-layer-group" style="color:var(--primary);"></i> Start Working</div>
            <div id="ad-zone-3" class="mobile-ad-container"></div>

            <div class="session-card" onclick="openFullPageSession(1)">
                <div class="session-info">
                    <h3>Session 01</h3>
                    <div id="sess1-earn" class="session-earn">Loading...</div>
                </div>
                <i class="fas fa-play-circle play-icon"></i>
            </div>
            <div id="ad-zone-4" class="mobile-ad-container"></div>
            
            <div class="session-card" onclick="openFullPageSession(2)">
                <div class="session-info">
                    <h3>Session 02</h3>
                    <div id="sess2-earn" class="session-earn">Loading...</div>
                </div>
                <i class="fas fa-play-circle play-icon"></i>
            </div>
            <div id="ad-zone-5" class="mobile-ad-container"></div>

            <div class="session-card" onclick="openFullPageSession(3)">
                <div class="session-info">
                    <h3>Session 03</h3>
                    <div id="sess3-earn" class="session-earn">Loading...</div>
                </div>
                <i class="fas fa-play-circle play-icon"></i>
            </div>

            <div class="card" style="margin-top:20px;">
                <h4 style="margin-bottom:10px; font-size:0.9rem; color:var(--text-sec); text-transform:uppercase;">RULES & GUIDELINES</h4>
                <div id="comp-desc" class="rules-content">Loading rules...</div>
                <div id="see-more-trigger" class="see-more-btn" onclick="toggleRules()">See More <i class="fas fa-chevron-down"></i></div>
            </div>

            <div id="ad-zone-6" class="mobile-ad-container"></div>
            <div class="section-title"><i class="fas fa-headset" style="color:var(--primary);"></i> Admin Support</div>
            <div id="ad-zone-7" class="mobile-ad-container"></div>
            <div id="support-area" class="support-grid"><div class="card" style="text-align:center;">Loading...</div></div>
            <br><br>
        </div>
    </div>

    <!-- === 4. NEW: FULL PAGE SESSION VIEW (SCROLL FIXED) === -->
    <div id="full-session-view" class="full-page-overlay">
        <!-- Header stays fixed at top -->
        <div class="full-page-header">
            <div style="font-weight:700; font-size:1.1rem;" id="full-sess-title">Session Details</div>
            <i class="fas fa-times" style="font-size:1.5rem; cursor:pointer;" onclick="closeFullSession()"></i>
        </div>

        <!-- HTML Container (Scrolls independently) -->
        <div id="session-html-container" class="html-container">
            <!-- Iframe renders content, padding is handled in JS inject -->
            <iframe id="content-frame" class="html-frame" sandbox="allow-scripts allow-same-origin allow-forms allow-popups"></iframe>
        </div>

        <!-- Button Floating above -->
        <button id="btn-start-task" class="btn">
            START TASK <i class="fas fa-arrow-right"></i>
        </button>
    </div>

    <!-- === 5. MODALS === -->
    <div id="personal-msg-modal" class="modal" style="display:none;">
        <div class="modal-content-box animate-up" style="text-align:center; max-width:350px;">
            <i class="fas fa-envelope-open-text" style="font-size:3rem; color:var(--primary); margin-bottom:10px;"></i>
            <h3 class="msg-title" style="margin-bottom:10px;">New Message</h3>
            <img id="p-msg-img" src="" style="width:100%; border-radius:12px; margin-bottom:15px; display:none;">
            <div id="p-msg-text" style="text-align:center; color:var(--text-main); font-size:1rem; margin-bottom:20px;"></div>
            <button class="btn" onclick="closePersonalMsg()" style="background:#333; color:#fff;">OK, Got it</button>
        </div>
    </div>

    <div id="info-modal" class="modal">
        <div class="modal-content-box animate-up">
            <div class="modal-header">
                <span class="modal-title" id="info-title">Information</span>
                <i class="fas fa-times close-btn" onclick="closeInfo()"></i>
            </div>
            <div id="info-body">Content goes here...</div>
        </div>
    </div>

    <div id="popup-modal" class="modal">
        <div class="modal-content-box animate-up">
            <div class="modal-header">
                <span class="modal-title">Notification</span>
                <i class="fas fa-times close-btn" onclick="closePopup()"></i>
            </div>
            <div id="popup-content" style="text-align:center;">
                <img id="popup-img" src="" class="hide" style="width:100%; border-radius:12px; margin-bottom:15px;">
                <p id="popup-desc" style="margin-bottom:15px;">No new updates.</p>
                <a id="popup-btn" href="#" class="btn" style="display:inline-block; text-decoration:none;">Join Channel</a>
            </div>
        </div>
    </div>

    <div id="settings-modal" class="modal">
        <div class="modal-content-box animate-up">
            <div class="modal-header">
                <span class="modal-title">My Profile</span>
                <i class="fas fa-times close-btn" onclick="closeSettings()"></i>
            </div>
            <div style="text-align:center; margin-bottom:20px;">
                <img id="set-pic" src="" style="width:90px; height:90px; border-radius:50%; object-fit:cover; border:3px solid var(--primary); margin-bottom:15px;">
                <div style="display:flex; gap:10px;">
                    <input id="new-pic-url" class="form-control" placeholder="Image URL" style="margin-bottom:0; padding-left:14px; font-size:0.85rem;">
                    <button class="btn" style="width:auto; padding:0 20px; margin-top:0;" onclick="updatePic()">Update</button>
                </div>
            </div>
            <div class="credential-box">
                <h4 style="font-size:0.9rem; margin-bottom:10px; color:var(--text-sec);">My Credentials</h4>
                <div class="cred-row">
                    <span>Fworker ID:</span>
                    <div><span id="profile-phone-display" class="cred-val">***********</span><i class="fas fa-copy cred-icon" onclick="copyCred('phone')"></i></div>
                </div>
                <div class="cred-row">
                    <span>Password:</span>
                    <div>
                        <span id="profile-pass-display" class="cred-val">********</span>
                        <i id="icon-profile-pass" class="fas fa-eye cred-icon" onclick="toggleProfilePass()"></i>
                        <i class="fas fa-copy cred-icon" onclick="copyCred('pass')"></i>
                    </div>
                </div>
            </div>
            <div class="card" style="display:flex; justify-content:space-between; align-items:center; margin-top:15px; margin-bottom:5px;">
                <span style="font-weight:600;"><i class="fas fa-moon"></i> Dark Mode</span>
                <label class="toggle-switch">
                    <input type="checkbox" id="dark-toggle" onchange="toggleTheme(this.checked)">
                    <span class="slider"></span>
                </label>
            </div>
            <button class="btn" style="background: #EF4444; color:white; margin-top:25px;" onclick="logout()">Logout Account</button>
        </div>
    </div>

    <div class="bottom-nav">
        <div class="nav-item active"><i class="fas fa-home"></i> Home</div>
        <div class="nav-item" onclick="openSettings()"><i class="fas fa-user-cog"></i> Profile</div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyB5flOMBRX6b_gAx7nicSDGd6iGV_c5AVU",
            authDomain: "fworker-shide.firebaseapp.com",
            databaseURL: "https://fworker-shide-default-rtdb.firebaseio.com",
            projectId: "fworker-shide",
            storageBucket: "gs://ludo-vip-9b3da.appspot.com",
            messagingSenderId: "244655390952",
            appId: "1:244655390952:web:af4176b78f0c34d73dc95d"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        let uid = localStorage.getItem('fw_uid');
        let userData = {};
        let popupData = {};
        let configData = {};
        let currentSessNum = 0;
        let profileShowPass = false;
        
        // Default Ad Code
        const defaultAdCode = `<script>atOptions={'key':'ec484170bacba8bf4dce215bb57b8e90','format':'iframe','height':50,'width':320,'params':{}};<\\/script><script src="https://www.highperformanceformat.com/ec484170bacba8bf4dce215bb57b8e90/invoke.js"><\\/script>`;

        // Init
        document.addEventListener('DOMContentLoaded', () => {
            if(uid) {
                checkStatus();
            } else {
                document.getElementById('loading-screen').classList.add('hide');
                showLogin();
            }

            // Load Public Config
            db.ref('config').on('value', s => {
                const c = s.val() || {};
                configData = c;
                
                // --- LOGO UPDATE LOGIC ---
                // If admin sets a logo URL, it will update automatically. 
                // Default is placeholder if null.
                const logoUrl = c.appLogo || 'https://via.placeholder.com/180x50';
                
                const mainLogo = document.getElementById('app-logo-main');
                const loginLogo = document.getElementById('login-logo-img');
                const regLogo = document.getElementById('reg-logo-img');
                
                if(mainLogo) mainLogo.src = logoUrl;
                if(loginLogo) loginLogo.src = logoUrl;
                if(regLogo) regLogo.src = logoUrl;

                if(c.entryPopup) {
                    document.getElementById('entry-banner-img').src = c.entryPopup.img || 'https://via.placeholder.com/300x150';
                    document.getElementById('entry-title').innerText = c.entryPopup.title || 'Welcome';
                    document.getElementById('entry-desc').innerText = c.entryPopup.desc || '';
                    document.getElementById('btn-join-tg').href = c.entryPopup.tgLink || '#';
                    document.getElementById('btn-join-pay').href = c.entryPopup.payLink || '#';
                }
                
                if(c.loginText) document.getElementById('login-desc-text').innerText = c.loginText;
                if(c.notice) document.getElementById('notice-text').innerText = c.notice;
                if(c.rules) document.getElementById('comp-desc').innerText = c.rules;
                if(c.links) {
                    document.getElementById('lnk-fb').href = c.links.fb || '#';
                    document.getElementById('lnk-tg').href = c.links.tg || '#';
                    document.getElementById('lnk-pay').href = c.links.pay || '#';
                    document.getElementById('lnk-yt').href = c.links.yt || '#';
                }
                if(c.sessions) {
                    document.getElementById('sess1-earn').innerText = c.sessions.session1?.price || 'Earn: --';
                    document.getElementById('sess2-earn').innerText = c.sessions.session2?.price || 'Earn: --';
                    document.getElementById('sess3-earn').innerText = c.sessions.session3?.price || 'Earn: --';
                }
                if(c.popup) popupData = c.popup;
                const adSettings = c.adSettings || { master: true };
                const ads = c.ads || {};
                if(adSettings.master !== false) {
                    ['zone1','zone2','zone3','zone4','zone5','zone6','zone7','zone8'].forEach(z => {
                        if(adSettings[z] !== false) renderAd(`ad-${z}`, ads[z] || defaultAdCode);
                        else hideAd(`ad-${z}`);
                    });
                } else {
                    document.querySelectorAll('.mobile-ad-container').forEach(el => el.style.display = 'none');
                }
            });
        });

        // Ad Functions
        function renderAd(zoneId, adCode) {
            const container = document.getElementById(zoneId);
            if (!container) return;
            container.style.display = 'flex'; container.innerHTML = ''; 
            const iframe = document.createElement('iframe');
            iframe.width = "320"; iframe.height = "60"; 
            iframe.style.border = "0"; iframe.style.overflow = "hidden";
            container.appendChild(iframe);
            const doc = iframe.contentWindow.document;
            doc.open(); doc.write(`<html><body style="margin:0;padding:0;display:flex;justify-content:center;align-items:center;">${adCode}</body></html>`); doc.close();
        }
        function hideAd(zoneId) { const c = document.getElementById(zoneId); if(c) c.style.display = 'none'; }

        // Auth Logic
        function userRegister() {
            const name = document.getElementById('reg-name').value;
            const fw = document.getElementById('reg-fw').value;
            const email = document.getElementById('reg-email').value;
            const pass = document.getElementById('reg-pass').value;
            const pay = document.getElementById('reg-pay').value;
            const proof = document.getElementById('reg-proof').value; 
            if(!name || !email || !pass || !fw || !proof) return alert("Fill all fields including Screenshot Link");
            const newUid = 'user_' + Date.now();
            const data = { uid: newUid, name, email, password: pass, fworkerNum: fw, paymentNum: pay, screenshotLink: proof, status: 'pending', joinedAt: firebase.database.ServerValue.TIMESTAMP };
            db.ref('users/' + newUid).set(data).then(() => { localStorage.setItem('fw_uid', newUid); location.reload(); });
        }
        async function userLogin() {
            const fwNum = document.getElementById('log-fw').value; 
            const pass = document.getElementById('log-pass').value;
            if(!fwNum || !pass) return alert("Enter Fworker Number and Password");
            const snap = await db.ref('users').orderByChild('fworkerNum').equalTo(fwNum).once('value');
            let found = false;
            snap.forEach(c => {
                const u = c.val();
                if(u.password === pass) {
                    found = true;
                    localStorage.setItem('fw_uid', u.uid);
                    location.reload(); 
                }
            });
            if(!found) alert("Invalid Credentials");
        }
        
        function checkStatus() {
            db.ref('users/' + uid).on('value', s => {
                const u = s.val();
                document.getElementById('loading-screen').classList.add('hide'); 
                
                if(!u) {
                    logout(); return; 
                }
                userData = u;
                document.querySelectorAll('.full-screen').forEach(e => e.classList.add('hide'));
                
                if(u.status === 'pending') document.getElementById('pending-screen').classList.remove('hide');
                else if(u.status === 'blocked') { alert("Account Blocked"); logout(); }
                else if(u.status === 'approved') loadApp();
            }, error => {
                document.getElementById('loading-screen').classList.add('hide');
                showLogin();
            });
        }

        function loadApp() {
            document.getElementById('main-app').classList.remove('hide');
            document.getElementById('main-app').classList.add('animate-up');
            document.getElementById('head-name').innerHTML = userData.name + ' <i class="fas fa-check-circle verified"></i>';
            document.getElementById('head-email').innerHTML = `<i class="fas fa-envelope"></i> ${userData.email}`;
            document.getElementById('head-phone').innerHTML = `<i class="fas fa-id-card"></i> ${userData.fworkerNum}`;
            document.getElementById('head-pic').src = userData.profilePic || 'https://via.placeholder.com/100';
            document.getElementById('set-pic').src = userData.profilePic || 'https://via.placeholder.com/100';
            document.getElementById('profile-phone-display').innerText = userData.fworkerNum;
            if(userData.settings && userData.settings.darkMode) {
                document.body.classList.add('dark-mode');
                document.getElementById('dark-toggle').checked = true;
            }
            loadSupport();
            checkPersonalMsg();
            if(!sessionStorage.getItem('popupShown')) {
                document.getElementById('entry-popup').style.display = 'flex';
                sessionStorage.setItem('popupShown', 'true');
            }
        }

        function toggleProfilePass() {
            const passEl = document.getElementById('profile-pass-display');
            const icon = document.getElementById('icon-profile-pass');
            if(profileShowPass) { passEl.innerText = "********"; icon.className = "fas fa-eye cred-icon"; profileShowPass = false; }
            else { passEl.innerText = userData.password; icon.className = "fas fa-eye-slash cred-icon"; profileShowPass = true; }
        }
        function copyCred(type) {
            let txt = type === 'phone' ? userData.fworkerNum : userData.password;
            navigator.clipboard.writeText(txt).then(() => alert(type === 'phone' ? "ID Copied!" : "Password Copied!"));
        }

        // --- FIXED FULL PAGE SESSION LOGIC ---
        function openFullPageSession(num) {
            currentSessNum = num;
            const overlay = document.getElementById('full-session-view');
            const btn = document.getElementById('btn-start-task');
            
            overlay.style.display = 'flex'; // Changed to flex for proper layout
            document.getElementById('full-sess-title').innerText = "Session " + num;
            btn.style.display = 'block';

            injectContent("<h3>Loading Info...</h3>");

            db.ref(`config/sessions/session${num}`).once('value', s => {
                const d = s.val() || {};
                const content = d.html_info || d.html || "<h3>No info available.</h3>";
                injectContent(content);
            });
            
            btn.onclick = () => {
                btn.style.display = 'none'; 
                injectContent("<h3>Loading Task... Please wait.</h3>");
                
                db.ref(`config/sessions/session${num}`).once('value', s => {
                    const d = s.val() || {};
                    if(d.html_task && d.html_task.length > 10) {
                        injectContent(d.html_task);
                    } else if(d.link) {
                        const frame = document.getElementById('content-frame');
                        frame.removeAttribute('srcdoc'); 
                        frame.src = d.link; 
                    } else {
                        injectContent("<h3>Task content not set by admin.</h3>");
                    }
                });
            };
        }

        function injectContent(html) {
            const frame = document.getElementById('content-frame');
            // Adding extra padding bottom to body so button doesn't cover content
            // Also enabling scroll inside iframe body
            frame.srcdoc = `
                <!DOCTYPE html>
                <html>
                <head>
                    <meta name="viewport" content="width=device-width, initial-scale=1.0">
                    <style>
                        body { 
                            font-family: 'Poppins', sans-serif; 
                            margin: 0; 
                            padding: 15px; 
                            padding-bottom: 90px; /* Extra padding for floating button */
                            overflow-y: auto;
                        }
                        img { max-width: 100%; height: auto; border-radius: 8px; }
                    </style>
                </head>
                <body>${html}</body>
                </html>
            `;
        }

        function closeFullSession() { 
            document.getElementById('full-session-view').style.display = 'none'; 
            document.getElementById('content-frame').srcdoc = "";
            document.getElementById('content-frame').src = "";
        }
        
        function closeEntryPopup() { document.getElementById('entry-popup').style.display = 'none'; }
        function showLogin(){ document.getElementById('login-screen').classList.remove('hide'); document.getElementById('register-screen').classList.add('hide'); }
        function showRegister(){ document.getElementById('login-screen').classList.add('hide'); document.getElementById('register-screen').classList.remove('hide'); }
        function createLink() { window.open(configData.imgHostLink || "https://imgbb.com", '_blank'); }
        function logout() { localStorage.removeItem('fw_uid'); location.reload(); }
        function toggleRules() {
            const content = document.getElementById('comp-desc');
            const btn = document.getElementById('see-more-trigger');
            content.classList.toggle('expanded');
            btn.innerHTML = content.classList.contains('expanded') ? 'See Less <i class="fas fa-chevron-up"></i>' : 'See More <i class="fas fa-chevron-down"></i>';
        }
        function loadSupport() {
            db.ref('config/support').on('value', s => {
                const d = s.val(); if(!d) return;
                let html = '';
                ['admin1', 'admin2'].forEach(k => {
                    const adm = d[k];
                    if(adm && adm.name) {
                        html += `<div class="admin-card"><img src="${adm.pic}" class="admin-pic"><div class="admin-name">${adm.name}</div><div class="contact-btns"><a href="${adm.wa}" class="c-btn btn-wa"><i class="fab fa-whatsapp"></i></a><a href="${adm.tg}" class="c-btn btn-tg"><i class="fab fa-telegram-plane"></i></a></div></div>`;
                    }
                });
                document.getElementById('support-area').innerHTML = html || '<p>Offline</p>';
            });
        }
        function checkPersonalMsg() {
            db.ref('users/' + uid + '/inbox_msg').on('value', s => {
                const msg = s.val();
                if(msg) {
                    document.getElementById('p-msg-text').innerHTML = msg.text;
                    document.getElementById('personal-msg-modal').style.display = 'flex';
                    if(msg.img) { document.getElementById('p-msg-img').src = msg.img; document.getElementById('p-msg-img').style.display = 'block'; }
                }
            });
        }
        function closePersonalMsg() { db.ref('users/' + uid + '/inbox_msg').remove(); document.getElementById('personal-msg-modal').style.display = 'none'; }
        function showInfo(t) {
            document.getElementById('info-modal').style.display = 'flex';
            let txt = t==='privacy'?configData.privacyPolicy:t==='about'?configData.aboutUs:configData.rules;
            document.getElementById('info-body').innerText = txt || "Loading...";
            document.getElementById('info-title').innerText = t.toUpperCase();
        }
        function closeInfo(){ document.getElementById('info-modal').style.display = 'none'; }
        function showPopup() {
            document.getElementById('popup-modal').style.display = 'flex';
            document.getElementById('popup-desc').innerText = popupData.desc || "No new updates.";
            document.getElementById('popup-btn').href = popupData.link || "#";
        }
        function closePopup() { document.getElementById('popup-modal').style.display = 'none'; }
        function openSettings() { document.getElementById('settings-modal').style.display = 'flex'; }
        function closeSettings() { document.getElementById('settings-modal').style.display = 'none'; }
        function updatePic() { const u = document.getElementById('new-pic-url').value; if(u) db.ref(`users/${uid}/profilePic`).set(u).then(()=>alert("Updated")); }
        function toggleTheme(d) { document.body.classList.toggle('dark-mode', d); db.ref(`users/${uid}/settings/darkMode`).set(d); }
    </script>
</body>
</html>
<!-- --- END OF FILE User_Panel_Final_Pro.html --- -->